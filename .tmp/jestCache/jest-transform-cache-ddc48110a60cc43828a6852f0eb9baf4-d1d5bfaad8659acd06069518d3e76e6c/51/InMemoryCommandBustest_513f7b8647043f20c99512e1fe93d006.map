{"file":"/Users/david/Documents/bank-auth/src/tests/Contexts/Shared/infrastructure/CommandBus/InMemoryCommandBus.test.ts","mappings":";;;;;;;;;;;AAAA,0EAAuE;AAEvE,8GAA2G;AAC3G,mIAAgI;AAChI,mHAAgH;AAEhH,MAAM,gBAAiB,SAAQ,iBAAO;;AAC7B,6BAAY,GAAG,mBAAmB,CAAC;AAG5C,MAAM,cAAe,SAAQ,iBAAO;;AAC3B,2BAAY,GAAG,iBAAiB,CAAC;AAG1C,MAAM,gBAAgB;IACpB,YAAY;QACV,OAAO,cAAc,CAAC;IACxB,CAAC;IAEK,MAAM,CAAC,OAAuB;8DAAkB,CAAC;KAAA;CACxD;AAED,QAAQ,CAAC,oBAAoB,EAAE,GAAG,EAAE;IAClC,EAAE,CAAC,yDAAyD,EAAE,GAAS,EAAE;QACvE,MAAM,gBAAgB,GAAG,IAAI,gBAAgB,EAAE,CAAC;QAChD,MAAM,0BAA0B,GAAG,IAAI,uDAA0B,CAAC,EAAE,CAAC,CAAC;QACtE,MAAM,UAAU,GAAG,IAAI,uCAAkB,CAAC,0BAA0B,CAAC,CAAC;QAEtE,IAAI,SAAS,GAAG,IAAI,CAAC;QAErB,IAAI;YACF,MAAM,UAAU,CAAC,QAAQ,CAAC,gBAAgB,CAAC,CAAC;SAC7C;QAAC,OAAO,KAAK,EAAE;YACd,SAAS,GAAG,KAAK,CAAC;SACnB;QAED,MAAM,CAAC,SAAS,CAAC,CAAC,cAAc,CAAC,qDAAyB,CAAC,CAAC;QAC5D,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,oEAAoE,CAAC,CAAC;IACvG,CAAC,CAAA,CAAC,CAAC;IAEH,EAAE,CAAC,gCAAgC,EAAE,GAAS,EAAE;QAC9C,MAAM,cAAc,GAAG,IAAI,cAAc,EAAE,CAAC;QAC5C,MAAM,gBAAgB,GAAG,IAAI,gBAAgB,EAAE,CAAC;QAChD,MAAM,0BAA0B,GAAG,IAAI,uDAA0B,CAAC,CAAC,gBAAgB,CAAC,CAAC,CAAC;QACtF,MAAM,UAAU,GAAG,IAAI,uCAAkB,CAAC,0BAA0B,CAAC,CAAC;QAEtE,OAAO,CAAC,GAAG,CAAC,6CAA6C,CAAC,CAAA;QAC1D,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAA;QACvB,OAAO,CAAC,GAAG,CAAC,6CAA6C,CAAC,CAAA;QAE1D,MAAM,UAAU,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;IAC5C,CAAC,CAAA,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","names":[],"sources":["/Users/david/Documents/bank-auth/src/tests/Contexts/Shared/infrastructure/CommandBus/InMemoryCommandBus.test.ts"],"sourcesContent":["import { Command } from \"../../../../../modules/Shared/domain/Command\";\nimport { CommandHandler } from \"../../../../../modules/Shared/domain/CommandHandler\";\nimport { CommandNotRegisteredError } from \"../../../../../modules/Shared/domain/CommandNotRegisteredError\";\nimport { CommandHandlersInformation } from \"../../../../../modules/Shared/infrastructure/CommandBus/CommandHandlersInformation\";\nimport { InMemoryCommandBus } from \"../../../../../modules/Shared/infrastructure/CommandBus/InMemoryCommandBus\";\n\nclass UnhandledCommand extends Command {\n  static COMMAND_NAME = \"unhandled.command\";\n}\n\nclass HandledCommand extends Command {\n  static COMMAND_NAME = \"handled.command\";\n}\n\nclass MyCommandHandler implements CommandHandler<HandledCommand> {\n  subscribedTo(): HandledCommand {\n    return HandledCommand;\n  }\n\n  async handle(command: HandledCommand): Promise<void> {}\n}\n\ndescribe(\"InMemoryCommandBus\", () => {\n  it(\"throws an error if dispatches a command without handler\", async () => {\n    const unhandledCommand = new UnhandledCommand();\n    const commandHandlersInformation = new CommandHandlersInformation([]);\n    const commandBus = new InMemoryCommandBus(commandHandlersInformation);\n\n    let exception = null;\n\n    try {\n      await commandBus.dispatch(unhandledCommand);\n    } catch (error) {\n      exception = error;\n    }\n\n    expect(exception).toBeInstanceOf(CommandNotRegisteredError);\n    expect(exception.message).toBe(`The command <UnhandledCommand> hasn't a command handler associated`);\n  });\n\n  it(\"accepts a command with handler\", async () => {\n    const handledCommand = new HandledCommand();\n    const myCommandHandler = new MyCommandHandler();\n    const commandHandlersInformation = new CommandHandlersInformation([myCommandHandler]);\n    const commandBus = new InMemoryCommandBus(commandHandlersInformation);\n\n    console.log(\"*******************************************\")\n    console.log(commandBus)\n    console.log(\"*******************************************\")\n\n    await commandBus.dispatch(handledCommand);\n  });\n});\n"],"version":3}